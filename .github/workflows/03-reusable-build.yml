name: 03 - Reusable Build Workflow

on: workflow_call
# on:
#  workflow_call:
#    inputs:
#      node-version:
#        description: "VersiÃ³n de Node.js a usar"
#        required: false
#        default: "20"
#      build-command:
#        description: "Comando de build del proyecto"
#        required: false
#        default: "npm run build"
#    secrets:
#      NPM_TOKEN:
#        required: false
#        description: "Token opcional para npm"
#    outputs:
#      build-path:
#        description: "Directorio del build"
#        value: ${ { jobs.build.outputs.build-path }}

jobs:
  build:
    name: ğŸ”§ Build Job
    runs-on: ubuntu-latest
    outputs:
      build-path: ${ { steps.output-path.outputs.path }}

    steps:
      - name: ğŸ“¥ Checkout del repositorio
        run: |
          # Clonar el repositorio al runner para trabajar con el cÃ³digo

      - name: ğŸ§© Configurar Node.js
        run: |
          # Instalar Node.js segÃºn la versiÃ³n del input
          # Habilitar cache de npm para acelerar instalaciÃ³n de dependencias
          # "inputs":
            # "node-version: ${ { inputs.node-version }}"
            # "cache: npm"

      - name: ğŸ“¦ Instalar dependencias
        run: |
          # Instalar dependencias del proyecto con npm
          # "run": "npm ci"

      - name: ğŸ—ï¸ Ejecutar build
        run: |
          # Ejecutar el comando de build recibido como input
          # "run": "${ { inputs.build-command }}"

      - name: ğŸ’¾ Guardar artefacto del build
        run: |
          # Guardar la carpeta 'dist/' como artefacto para otros workflows
          # "artifact-name": "build-output"
          # "artifact-path": "dist/"

      - name: ğŸ”„ Exportar ruta del build
        run: |
          # Definir output del job para que otros workflows puedan usarlo
          # "id": "output-path"
          # "run": "echo path=dist >> $GITHUB_OUTPUT"

      - name: âœ… Resumen | Workflow completado
        run: |
          echo "ğŸ¯ Build finalizado correctamente"
          echo "ğŸ“ Ruta del build exportada: dist/"
          echo "ğŸ“˜ Siguiente paso: explorar 04-reusable-test.yml"
